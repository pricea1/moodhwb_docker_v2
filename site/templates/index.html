{#
 # Homepage template
 # ---------------
 #}
{% set userStatus = craft.userLogin.getUserStatus() %}

{% set summaryScore = craft.profiler.getSummaryMoodScore() %}
{% set lastViewedModuleId = craft.moduleactions.getLastViewedModuleId() %}
{% if lastViewedModuleId %}
	{% set lastViewedModule = craft.entries.id(lastViewedModuleId).one() %}
{% endif %}

{% import '_macros/dashboard-module' as dashboardModuleMacro %}

{% extends "_layout" %}

{% set userStatus = "returnLong" %}

{% block content %}
	<div class="primary-panel home-container">
		
		<div class="row"><!--
		--><div class="small-12 column">
			<div class="home-top-section-container">
				{% switch userStatus %}
						{% case "newUser" %}
							{% include "./_partials/homepage-new-user-header.twig" %}
						
						{% case "unansweredQuestions"%}
							{% include "./_partials/homepage-user-unanswered.twig" %}

						{% case "returnShort" %}
							{% include "./_partials/homepage-user-return-short.twig" %}

						{% case "returnMedium" %}
							{% include "./_partials/homepage-user-return-medium.twig" %}

						{% case "returnLong" %}
							{% include "./_partials/homepage-user-return-long.twig" %}

					{% endswitch %}				

				</div>
			</div>
		</div>

		<div class="home-second-section">
			<div class="row">
			<div class="small-12 column">
				<div class="home-browse">
					{% if lastViewedModule is not defined %}
						{{ "Browse the topics"| t}}
					{% else %}
						{{ "Within each topic we've highlighted"|t }} <span class="material-icons home-highlight-star">star</span> {{ " the number of areas that might be helpful based on your answers"|t }}
					{% endif %}
				</div>

				{% set modules = craft.entries.section('modules').level('1') %}

					<div class="home-module-container">
					{% for module in modules.limit(6) %}	
						{{ dashboardModuleMacro.renderDashboardModule(module, userStatus, lastViewedModule) }}
					{% endfor %}
					</div>
					
			</div>
			</div>

			<div class="row">
				<div class="home-module-separator">
				<div class="small-12">
					<div class="home-module-container">
					{% set friendsModule =craft.entries.slug('families-friends-and-carers').one() %}
					{{ dashboardModuleMacro.renderDashboardModule(friendsModule, userStatus, lastViewedModule) }}
					{% set about = craft.entries.slug('about-this').one() %}
					{{ dashboardModuleMacro.renderDashboardModule(about, userStatus, lastViewedModule) }}

					</div>
				</div>
				</div>
			</div>

		</div>

		{% if entry.video %}
			{% include '_partials/video' %}
		{% endif %}
	</div>
	{% include '_partials/strapline' %}



{% endblock %}

{% block jsBlock %}
<script type="text/javascript">
	opad.initJsModule(['homepage']);
</script>
{% endblock %}
