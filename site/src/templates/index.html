{#
 # Homepage template
 # ---------------
 #}
{% set userStatus = craft.userLogin.getUserStatus() %}
{% set summaryScore = craft.profiler.getSummaryMoodScore() %}
{% set lastViewedModuleId = craft.moduleactions.getLastViewedModuleId() %}
{% if lastViewedModuleId %}
	{% set lastViewedModule = craft.entries.id(lastViewedModuleId).one() %}
{% endif %}

{% extends "_layout" %}

{% block content %}

	<div class="primary-panel home-container">
		
		<div class="row"><!--
		--><div class="small-12 column">
			<div class="home-top-section-container">
					{% switch userStatus %}
						{% case "newUser" %}
								{% include "./_partials/homepage-new-user-header.twig" %}
						{% case "unansweredQuestions"%}
							{% include "./_partials/homepage-user-unanswered.twig" %}

						{% case "returnShort" %}
							{% include "./_partials/homepage-user-return-short.twig" %}

						{% case "returnMedium" %}
							{% include "./_partials/homepage-user-return-medium.twig" %}

						{% case "returnLong" %}
							{% include "./_partials/homepage-user-return-long.twig" %}

					{% endswitch %}				

				</div>
			</div>
		</div>

		<div class="home-second-section">
			<div class="row">
			<div class="small-12 column">
				<div class="home-browse">
					{% if lastViewedModule is not defined %}
						{{ "Browse the topics"| t}}
					{% else %}
						{{ "Within each topic weâ€™ve highlighted"|t }} <span class="material-icons home-highlight-star">star</span> {{ " the number of areas that might be helpful based on your answers"|t }}
					{% endif %}
				</div>

				{% set modules = craft.entries.section('modules').level('1') %}
					<div class="home-module-container">
					{% for module in modules.all() %}	
							{% set image = module.image|first %}

							<div class="home-module-container-item {{ module.moduleColour }}">
								{% if userStatus != "newUser" %}
									{% include "./_partials/homepage-hints.twig" %}
								{% endif %}

								{% if image %}
									<div class="home-module-image-container">
										<div id="moduleRecommendedCounterContainer-{{module.id}}" class="home-module-recommended-counter-container">
											<div id="moduleRecommendedCounter-{{module.id}}" class="home-module-recommended-counter-container-item">5</div>
										</div>
										<img class="home-module-image-container-item" src="{{ image.imageFile.one().url }}" alt="{{ image.imageAlt }}" />
									</div>
								{% endif %}
								<div>
								<h4 class="home-module-heading">
								<a class="link" href="{{ module.url }}">
								{{ module.title }}
								</a>

								</h4>
							{{ module.body }}
							</div>
							</div>

					{% endfor %}
					</div>
			</div>
			</div>
		</div>

		{% if entry.video %}
			{% include '_partials/video' %}
		{% endif %}
	</div>
	{% include '_partials/strapline' %}



{% endblock %}

{% block jsBlock %}
<script type="text/javascript">
	opad.initJsModule(['homepage']);
</script>
{% endblock %}
